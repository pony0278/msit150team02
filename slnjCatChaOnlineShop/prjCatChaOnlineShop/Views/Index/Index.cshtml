@model IEnumerable<prjCatChaOnlineShop.Models.CModels.CProductItem>

@{
    ViewData["Title"] = "Home Page";
}

@section Styles{

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.2/css/star-rating.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.2/themes/krajee-fas/theme.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" />

    <link rel="stylesheet" href="~/css/review.css" />
    <!-- Site CSS -->
    <link rel="stylesheet" href="~/css/bootstrap.min.css">
            @* <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"> *@
    <link rel="stylesheet" href="~/css/style.css" />
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="~/css/responsive.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/css/chatbox.css" />
    <link rel="stylesheet" href="~/css/custom-home-details-wishlist.css" />
    <link rel="stylesheet" href="~/css/game/IndexAnimateforGame.css" />
    <style>
        .swiper-slide {
            width: 300px;
            filter: blur(1px);
            height: 100%;
            background: #ffff;
        }

        .swiper-slide-active {
            filter: blur(0px);
        }

        .swiper-pagination-bullet,
        .swiper-pagination-bullet-active {
            background: orange;
        }

        .swiper-slide h2 {
            color: black;
            font-family: "Roboto", sans-serif;
            font-weight: 400;
            font-size: 1.3rem;
            line-height: 1.4;
            margin-bottom: 15px;
            padding: 25px 45px 0 25px;
        }

        .swiper-3d .swiper-slide-shadow-left,
        .swiper-3d .swiper-slide-shadow-right {
            background-image: none;
        }

        .checked{
            color:orange;
        }
    </style>
}

<!-- Modal -->
<div class="toast-container position-fixed top-25 start-50 translate-middle">
    
    <div id="live-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <img src="..." class="rounded me-2" alt="...">
            <strong class="me-auto">訊息</strong>
            <small></small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
        </div>
    </div>
</div>
@* <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal Title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- 在這裡添加您想要顯示的內容 -->
                商品已成功加入購物車！
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">關閉</button>
            </div>
        </div>
    </div>
</div> *@
<!-- Start Slider -->
<div id="slides-shop" class="cover-slides">
    <ul class="slides-container">
        <li class="text-center">
            <img src="~/images/home-slide-1.jpg" alt="" />
            <div class="container">
                <div class="row d-flex justify-content-center align-items-end mb-5">
                    <div class="col-md-12 ">
                        <p><a class="btn hvr-hover" asp-controller="Index" asp-action="Shop">來去逛逛</a></p>
                    </div>
                </div>
            </div>
        </li>
        <li class="text-center">
            <img src="~/images/home-slide-2.jpg" alt="" />
            <div class="container">
                <div class="row d-flex justify-content-center align-items-end mb-5">
                    <div class="col-md-12">
                        <p><a class="btn hvr-hover" asp-controller="Index" asp-action="Shop">來去逛逛</a></p>
                    </div>
                </div>
            </div>
        </li>
        <li class="text-center">
            <img src="~/images/home-slide-3.jpg" alt="" />
            <div class="container">
                <div class="row d-flex justify-content-center align-items-end mb-5">
                    <div class="col-md-12">
                        <p><a class="btn hvr-hover" asp-controller="Index" asp-action="Shop">來去逛逛</a></p>
                    </div>
                </div>
            </div>
        </li>
    </ul>
    <div class="slides-navigation">
        <a href="#" class="next"><i class="fa fa-angle-right" aria-hidden="true"></i></a>
        <a href="#" class="prev"><i class="fa fa-angle-left" aria-hidden="true"></i></a>
    </div>
</div>
<!-- End Slider -->
<!-- start 貓寵補給站區域 -->
<div class="box-add-products position-relative">
    <div class="container padding-custom">
        <div class="home-title text-center">
            <h1>貓寵補給站</h1><div class="review"></div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-3 col-md-3 col-sm-6 div-center-custom">

                <div class="round-box-title">熱賣商品</div>
                <div class="round-box-custome offer-box-products">
                    <img class="text-center rounded-circle img-fluid" src="~/images/hot.png" alt="" />
                    <a asp-controller="Index" asp-action="Shop">
                        <div class="mask rounded-circle">
                        </div>
                    </a>
                </div>

            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 div-center-custom">
                <div class="round-box-title">貓咪玩具</div>
                <div class="round-box-custome offer-box-products">
                    <img class="text-center rounded-circle img-fluid" src="~/images/toy.png" alt="" />
                    <a asp-controller="Index" asp-action="Shop">
                        <div class="mask rounded-circle">
                        </div>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 div-center-custom">
                <div class="round-box-title">保健食品</div>
                <div class="round-box-custome offer-box-products">
                    <img class="text-center rounded-circle img-fluid" src="~/images/supplement.png" alt="" />
                    <a asp-controller="Index" asp-action="Shop">
                        <div class="mask rounded-circle">
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end 貓寵補給站區域 -->
<!-- Start 新進商品區域  -->
<div class="products-box">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="home-section-title">
                    <h2>新進商品!</h2>

                    <a asp-controller="Index" asp-action="Shop">
                        <span>瀏覽所有新商品</span>
                    </a>
                </div>
            </div>
        </div>
        <div id="productIndexNew" class="row special-list">
            @{
                foreach (var item in Model.ToList().OrderByDescending(p => p.p上架時間).Take(4))
                {
                    <!-- start prod  -->
                    <div class="col-lg-3 col-md-6 special-grid best-seller">
                        <div class="products-single-custom fix">
                            <a href="@Url.Action("ShopDetail", new {pId = item.pId })" class="shop-prod-click" title="@item.pName">
                                <div class="box-img-hover">
                                    <div class="type-lb">
                                        <p class="sale">Sale</p>
                                    </div>
                                    <img src="@item.p圖片路徑.FirstOrDefault()" class="img-fluid shop-image" alt="Image" />
                                </div>
                            </a>
                            <div class="why-text">
                                <h4>@item.pName</h4>
                                @if (item.pDiscount != null)
                                {
                                    <h5>$ @item.p優惠價格</h5>
                                    <del>$ @item.pPrice</del>
                                }
                                else
                                {
                                    <h5>$ @item.pPrice</h5>
                                }
                                <a data-product-id=@item.pId class="add-to-cart-coustom">
                                    <i class="fa-solid fa-cart-plus"></i>
                                </a>
                                <a href="#" data-product-id=@item.pId class="add-to-wishlist-coustom">
                                    <i class="far fa-heart"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <!-- end prod  -->
                }
            }
        </div>
    </div>
</div>
<!-- End 新進商品  -->
<!-- Start Blog  -->
<div class="container-fluid " id="sp-products">
    <div class="row justify-content-center" id="container">
    </div>
</div>
<!-- End Blog  -->
<!-- Start 熱賣商品區域  -->
<div class="products-box">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="home-section-title">
                    <h2>熱賣商品!</h2>
                    <a asp-controller="Index" asp-action="Shop">
                        <span>瀏覽所有熱賣商品</span>
                    </a>
                </div>
            </div>
        </div>
        <div id="productIndexSale" class="row special-list">
            @{
                foreach (var item in Model.OrderBy(p => p.p剩餘庫存).Take(4))
                {
                                <div class="col-lg-3 col-md-6 special-grid best-seller">
                                    <div class="products-single-custom fix">
                                        <a href="@Url.Action("ShopDetail", new {pId =  item.pId })" class="shop-prod-click" title="@item.pName">
                                            <div class="box-img-hover">
                                                <div class="type-lb">
                                                    <p class="sale">Sale</p>
                                                </div>
                                                <img src=@item.p圖片路徑.FirstOrDefault() class="img-fluid shop-image" alt="Image" />
                                            </div>
                                        </a>
                                        <div class="why-text">
                                            <h4>@item.pName</h4>
                                            @if (item.pDiscount != null)
                                {
                                        <h5>$ @item.p優惠價格</h5>
                                        <del>$ @item.pPrice</del>
                                }
                                else
                                {
                                        <h5>$ @item.pPrice</h5>
                                }
                                    <a href="#" data-product-id=@item.pId class="add-to-cart-coustom">
                                        <i class="fa-solid fa-cart-plus"></i>
                                    </a>
                                    <a href="#" data-product-id=@item.pId class="add-to-wishlist-coustom">
                                        <i class="far fa-heart"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- end prod1  -->
                }
            }

        </div>
    </div>
</div>
<!-- End 熱賣商品  -->
<!-- 開始評論輪播 -->

<div class="container mt-3">
    <div class="home-title text-center">
        <h1>推薦好評</h1>
    </div>
    <div class="swiper pt-3 pb-3">
        <div class="swiper-wrapper pb-4" id="swipers">

        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
    </div>
</div>



<!-- 結束評論輪播 -->
<!-- start側邊 -->
<div class="body-font-style" id="go-to-game" title="進入遊戲">
    <a asp-controller="Game" asp-action="Index">貓貓大進擊<i class="fa-solid fa-gamepad"></i></a>
</div>
<div id="body">
    <div id="chat-circle" class="btn btn-raised">
        <div id="chat-overlay"></div>
        <i class="fa-solid fa-headset"></i>
    </div>

    <div class="chat-box">
        <div class="chat-box-header">
            ChatBot
            <span class="chat-box-toggle"><i class="material-icons">X</i></span>
        </div>
        <div class="chat-box-body">
            <div class="chat-box-overlay">
            </div>
            <div class="chat-logs">
            </div><!--chat-log -->
        </div>
        <div class="chat-input">
            <form>
                <input type="text" id="chat-input" placeholder="Send a message..." />
                <button type="submit" class="chat-submit" id="chat-submit"><i class="material-icons">send</i></button>
            </form>
        </div>
    </div>



</div>
<!-- end 側邊 -->
<!-- 小動畫-->
<div id="fullScreenContainer">
    <div class="containers position-relative">
        <div class="position-absolute top-0 start-0">
            <div class="animate animate01">
                <div class="catAnimate"></div>
            </div>
        </div>
        <div class="position-absolute top-50 start-50 translate-middle">
            <div class="popup" id="my-popup">
                <img src="https://i.imgur.com/Db9cwjE.png" alt="Popup Image" class="popup-image">
            </div>
            <div class="animate animate02">
                <div class="catAnimate "></div>
            </div>
        </div>
        <div class="position-absolute bottom-0 end-0">
            <div class="animate animate03">
                <div class="catAnimate "></div>
            </div>
        </div>
    </div>
</div>


@section Scripts{

    <!-- ALL JS FILES -->
    <!-- 首頁跑版 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!--<script src="~/js/jquery-3.2.1.min.js"></script>-->
    <script src="~/js/popper.min.js"></script>

    <script src="~/js/review.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/js/bootstrap.min.js"></script>
    <script src="~/js/rating.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js"></script>

    <!-- ALL PLUGINS -->
    <script src="~/js/jquery.superslides.min.js"></script>
    <script src="~/js/bootstrap-select.js"></script>
    <script src="~/js/inewsticker.js"></script>
    <script src="~/js/bootsnav.js."></script>
    <script src="~/js/images-loded.min.js"></script>
    <script src="~/js/isotope.min.js"></script>
    <script src="~/js/owl.carousel.min.js"></script>
    <script src="~/js/baguetteBox.min.js"></script>
    <script src="~/js/form-validator.min.js"></script>
    <script src="~/js/contact-form-script.js"></script>
    <script src="~/js/custom.js"></script>

    <script>
        //所有頁面上不可有相同id
        var productIndexNew = $('#productIndexNew');
        var productIndexSale = $('#productIndexSale');

        // 點擊商品時獲取識別ID
        productIndexNew.on('click', '.shop-prod-click', function () {

            console.log(productIndexNew);
            var productId = $(this).data('product-id');
            console.log('Clicked product ID:', productId);
            $.ajax({
                url: '/ProductApi/GetDetail',
                type: 'GET',
                data: { pId: productId },
                dataType: 'html',
                success: function (response) {
                    console.log('GoToDetail:', response.message);
                },
                error: function (error) {
                    console.error('Ajax Error:', error);
                }
            });
        });
        productIndexSale.on('click', '.shop-prod-click', function () {
            console.log(productIndexSale);
            var productId = $(this).data('product-id');
            console.log('Clicked product ID:', productId);
            $.ajax({
                url: '/ProductApi/GetDetail',
                type: 'GET',
                data: { pId: productId },
                dataType: 'html',
                success: function (response) {
                    console.log('Added to Cart:', response.message);
                },
                error: function (error) {
                    console.error('Ajax Error:', error);
                }
            });
        });
        //加入購物車:獲取id---------------------------------------------------------

        productIndexNew.on('click', '.add-to-cart-coustom', function (e) {
            e.preventDefault(); // 阻止<a>標籤的點擊預設行為
            console.log(productIndexNew);
            var productId = $(this).data('product-id');
            console.log('Clicked Add to Cart, Product ID:', productId);
            // 透過 Ajax 將商品 ID 傳送到後端，加入購物車
            $.ajax({
                url: '/ProductApi/AddToCart',
                type: 'POST',
                data: { pId: productId },
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        $('.toast .toast-body').text(response.message);
                        $('.toast').toast('show');
                    }
                    else {
                        $('.toast .toast-body').text(response.message);
                        $('.toast').toast('show');
                    }
                },
                error: function (error) {
                    console.error('Ajax Error:', error);
                }
            });
        });

        productIndexSale.on('click', '.add-to-cart-coustom', function (e) {
            e.preventDefault(); // 阻止<a>標籤的點擊預設行為
            console.log(productIndexSale);
            var productId = $(this).data('product-id');
            console.log('Clicked Add to Cart, Product ID:', productId);
            // 透過 Ajax 將商品 ID 傳送到後端，加入購物車
            $.ajax({
                url: '/ProductApi/AddToCart',
                type: 'POST',
                data: { pId: productId },
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        $('.toast .toast-body').text(response.message);
                        $('.toast').toast('show');
                    }
                    else {
                        $('.toast .toast-body').text(response.message);
                        $('.toast').toast('show');
                    }
                },
                error: function (error) {
                }
            });
        });
        //加入收藏:獲取id--------------------------------------------------------

        productIndexNew.on('click', '.add-to-wishlist-coustom', function (e) {
            e.preventDefault(); // 阻止<a>標籤的點擊預設行為
            var button = $(this);
            var productId = $(this).data('product-id');
            console.log('Clicked Add to Cart, Product ID:', productId);
            // 透過 Ajax 將商品 ID 傳送到後端，加入購物車
            $.ajax({
                url: '/ProductApi/AddToWishlist',
                type: 'POST',
                data: { pId: productId },
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        isFavorited = !isFavorited; // 切換狀態
                        if (isFavorited) {
                            button.addClass("favorited");
                        } else {
                            button.removeClass("favorited");
                        }
                    }
                    else {
                        $('#live-toast .toast-body').text(response.message);
                        $('#live-toast').toast('show');
                    }
                },
                error: function (error) {
                    console.error('Ajax Error:', error);
                }
            });
        });
        productIndexSale.on('click', '.add-to-wishlist-coustom', function (e) {
            e.preventDefault(); // 阻止<a>標籤的點擊預設行為
            console.log(productIndexSale);
            var button = $(this);
            var productId = $(this).data('product-id');
            console.log('Clicked Add to Cart, Product ID:', productId);
            // 透過 Ajax 將商品 ID 傳送到後端，加入購物車
            $.ajax({
                url: '/ProductApi/AddToWishlist',
                type: 'POST',
                data: { pId: productId },
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        isFavorited = !isFavorited; // 切換狀態
                        if (isFavorited) {
                            button.addClass("favorited");
                        } else {
                            button.removeClass("favorited");
                        }
                    }
                    else {
                        $('#live-toast .toast-body').text(response.message);
                        $('#live-toast').toast('show');
                    }

                },
                error: function (error) {
                }
            });
        });
        //評論區



        $(function () {
            var INDEX = 0;
            $("#chat-submit").click(function (e) {
                e.preventDefault();
                var msg = $("#chat-input").val();
                if (msg.trim() == '') {
                    return false;
                }
                generate_message(msg, 'self');
                var buttons = [
                    {
                        name: 'Existing User',
                        value: 'existing'
                    },
                    {
                        name: 'New User',
                        value: 'new'
                    }
                ];
                setTimeout(function () {
                    generate_message(msg, 'user');
                }, 1000)

            })

            function generate_message(msg, type) {
                INDEX++;
                var str = "";
                str += "<div id='cm-msg-" + INDEX + "' class=\"chat-msg " + type + "\">";
                str += "          <span class=\"msg-avatar\">";
                str += "            <img src=\"https:\/\/image.crisp.im\/avatar\/operator\/196af8cc-f6ad-4ef7-afd1-c45d5231387c\/240\/?1483361727745\">";
                str += "          <\/span>";
                str += "          <div class=\"cm-msg-text\">";
                str += msg;
                str += "          <\/div>";
                str += "        <\/div>";
                $(".chat-logs").append(str);
                $("#cm-msg-" + INDEX).hide().fadeIn(300);
                if (type == 'self') {
                    $("#chat-input").val('');
                }
                $(".chat-logs").stop().animate({ scrollTop: $(".chat-logs")[0].scrollHeight }, 1000);
            }

            function generate_button_message(msg, buttons) {
                /* Buttons should be object array
                  [
                    {
                      name: 'Existing User',
                      value: 'existing'
                    },
                    {
                      name: 'New User',
                      value: 'new'
                    }
                  ]
                */
                INDEX++;
                var btn_obj = buttons.map(function (button) {
                    return "              <li class=\"button\"><a href=\"javascript:;\" class=\"btn btn-primary chat-btn\" chat-value=\"" + button.value + "\">" + button.name + "<\/a><\/li>";
                }).join('');
                var str = "";
                str += "<div id='cm-msg-" + INDEX + "' class=\"chat-msg user\">";
                str += "          <span class=\"msg-avatar\">";
                str += "            <img src=\"https:\/\/image.crisp.im\/avatar\/operator\/196af8cc-f6ad-4ef7-afd1-c45d5231387c\/240\/?1483361727745\">";
                str += "          <\/span>";
                str += "          <div class=\"cm-msg-text\">";
                str += msg;
                str += "          <\/div>";
                str += "          <div class=\"cm-msg-button\">";
                str += "            <ul>";
                str += btn_obj;
                str += "            <\/ul>";
                str += "          <\/div>";
                str += "        <\/div>";
                $(".chat-logs").append(str);
                $("#cm-msg-" + INDEX).hide().fadeIn(300);
                $(".chat-logs").stop().animate({ scrollTop: $(".chat-logs")[0].scrollHeight }, 1000);
                $("#chat-input").attr("disabled", true);
            }

            $(document).delegate(".chat-btn", "click", function () {
                var value = $(this).attr("chat-value");
                var name = $(this).html();
                $("#chat-input").attr("disabled", false);
                generate_message(name, 'self');
            })

            $("#chat-circle").click(function () {
                $("#chat-circle").toggle('scale');
                $(".chat-box").toggle('scale');
            })

            $(".chat-box-toggle").click(function () {
                $("#chat-circle").toggle('scale');
                $(".chat-box").toggle('scale');
            })

        })
        //小動畫
        const fullScreenContainer = document.getElementById('fullScreenContainer');
        document.getElementById("go-to-game").addEventListener("click", function (event) {
            //修復遊戲側邊按鈕
            event.preventDefault();
            //動畫內容
            main();
            $("#fullScreenContainer").addClass("fullscreen")
            $(".animate01").addClass("NyanCat-container01");
            $(".animate02").addClass("NyanCat-container02");

            $(".animate03").one("animationend", function () {
                $("#my-popup").addClass("show");
                setTimeout(function () {
                    $("#my-popup").removeClass("show");
                    window.location.href = '/Game/Index';
                }, 3000);
            })
                .addClass("NyanCat-container03");

            const nyanCats = document.querySelectorAll('.animate');
            if (nyanCats.length > 0) {
                nyanCats.forEach((cat) => {
                    cat.classList.add('NyanCat-container');
                });
            }

            const catAnimate = document.querySelectorAll('.catAnimate');
            if (catAnimate.length > 0) {
                catAnimate.forEach((cat) => {
                    cat.classList.add('NyanCat');
                });
            }

            function getRandomInt(min, max) {
                return Math.floor(Math.random() * (max - min)) + min;
            }


            function createLine() {
                const line = document.createElement('div');
                line.classList.add('line');
                line.style.width = `${getRandomInt(20, 100)}px`
                line.style.right = `${getRandomInt(window.innerWidth, 100)}px`;
                line.style.top = `${getRandomInt(0, window.innerHeight)}px`;
                fullScreenContainer.appendChild(line);
                return line;
            }


            function updateLine(line) {
                const newX = parseInt(line.style.right) + 10;
                if (newX > window.innerWidth) {
                    line.style.right = `${getRandomInt(0, -100)}px`;
                } else {
                    line.style.right = `${newX}px`;
                }
            }

            function main() {
                const lines = [];

                for (let i = 0; i < 100; i++) {
                    lines.push(createLine());
                }

                setInterval(() => {
                    lines.forEach(updateLine);
                }, 40);
            }
        });
        //小動畫結束

        //抓主打商品
        $(document).ready(function () {
            $.ajax({
                url: "@Url.Action("CountDownProduct","Index")",
                type: "GET",
                dataType: "json",
                success: function (response) {
                    var container = $("#container");
                    $.each(response.data, function (index, value) {
                        // Create a div to hold each product
                        var productDiv = $('<div class="col-md-6 d-flex position-relative"></div>');
                        var productDiscount = $('<div class="position-absolute top-0 start-0"><h1 class="ms-3 fs-1 text-secondary"></h1></div>').find('h1').text(value.discount).end();
                        var productCountTime = $('<div class="d-flex flex-column align-items-end"></div>').append('<h1 class="me-3 fs-1">倒數計時</h1>', `<h1 class="me-3 countTime fs-1">${value.offDay}</h1>`);
                        var productDivCountDownTime = $('<div class="z-1 position-absolute top-0 end-0"></div>').append(productCountTime);
                        var productInfo = $('<div class="d-flex flex-column align-items-center"></div>').append(`<h1 class="fs-1">限時特惠</h1>`, `<h1 class="fs-1">${value.productName}</h1>`, `<a class="fs-2 text-primary" href="/Index/ShopDetail?pid=${value.productId}" >點我看更多!</a> `);
                        var productDivProductName = $('<div class="position-absolute top-50 start-50 translate-middle"></div>').append(productInfo);
                        var img = $('<img class="z-0 w-100">').attr('src', "https://lh3.googleusercontent.com/pw/AIL4fc_EZtvazZta8E3dQDkDsLgRbKyZw6DYqDBCTjtypGTt2rEpp-8H7rTiNY3flHpe_TrzMXApKBWi6KDA67JGwfc6TYzhc_Ji3HXCDQtV1BErpFVrSmA=w1200");

                        productDiv.append(img, productDiscount, productDivCountDownTime, productDivProductName);
                        container.append(productDiv);
                    });
                    handleCountdown()
                },
                error: function (error) {
                    console.error("Error:", error);
                }
            });

        });
        //抓評論
        $.ajax({
            url: "@Url.Action("GetReivews","Index")",
            type: "GET",
            dataType: "json",
            success: function (response) {

                var swipers = $("#swipers")
                $.each(response.data, function (index, value) {
                    var reviewsDiv = $('<div class="swiper-slide swiper-slide--one position-relative shadow rounded"></div>')
                    const img = $(`<img src="${value.productPhoto}" class="img-thumbnail border-0">`)
                    const productName = $('<div class="position-absolute position-absolute top-0 start-0"></div>').append(`<h3 class="bg-warning text-dark ">${value.productName}</h3>`)
                    let stars = $('<div class="d-flex justify-content-around align-self-center mt-2 mb-3"></div>');
                    if(value.productRating == 5 ){
                        for(let i = 0; i<value.productRating ; i++){
                            stars.append('<span class="fs-1 fa fa-star checked "></span>');
                        }
                    }
                    const productdescription = $('<div class="d-flex justify-content-around align-self-center"></div>').append(`<blockquote class="fs-2" ><cite><q>${value.productdescription}</q></cite></blockquote>`)
                    const member = $('<div class="d-flex justify-content-around align-self-center mb-1"></div>').append(`<p>${value.member} <span>這樣說</span></p>`)
                    reviewsDiv.append(img, productName, stars, productdescription, member)
                    swipers.append(reviewsDiv)
                    console.log(response.data)
                })
                var swiper = new Swiper(".swiper", {
                    effect: "coverflow",
                    grabCursor: true,
                    centeredSlides: true,
                    slidesPerView: "auto",
                    coverflowEffect: {
                        rotate: 0,
                        stretch: 0,
                        depth: 100,
                        modifier: 2,
                        slideShadows: true
                    },
                    keyboard: {
                        enabled: true
                    },
                    mousewheel: {
                        thresholdDelta: 70
                    },
                    spaceBetween: 60,
                    loop: true,
                    pagination: {
                        el: ".swiper-pagination",
                        clickable: true
                    }
                });
            },
            error: function (error) {
                console.log("Error:", error)
            }
        })



        //倒數計時
        function handleCountdown() {
            const times = $(".countTime").map(function () {
                return new Date($(this).text()).getTime();
            }).get();
            const countTimes = setInterval(function () {
                const now = new Date().getTime();
                $(".countTime").each(function (index) {
                    const distance = times[index] - now;
                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    if (distance < 0) {
                        clearInterval(countTimes);
                        $(this).html("截止");
                    } else {
                        $(this).html(days + "天" + hours + "時" + minutes + "分" + seconds + "秒");
                    }
                });
            }, 1000);
        }


    </script>

}
